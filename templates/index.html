{% extends "fault.html" %}
{% import "macros.html" as macros %}
{% block head %}{{ super() }}
 <link rel=alternate type="application/atom+xml" href="/feed.xml">
 <link rel=stylesheet href="/main-page.css">
{% endblock head %}
{% block body %}
<main class="ml-article">
<section style="width: 21em; position: relative; padding: 1rem" id="top-wrapper">
	<div id="top">
	<img src="/avatar-black.svg" alt="Mat-ling" class=ml-wordmark />
		<h1>{{ config.title }}</h1>
		<p id=tagline>Remould,<br>to Heart’s Desire</p>
	</div>	
	<footer><i id=advanced class=dropdown-wrapper></i></footer>
</section>
<section class=card-block>
	<a class=ml-card-anchor style="grid-column: span 4" id=contrib 
	href="https://github.com/0xis-cn" rel="me" target=_blank>
		<h2>Contribution</h2>
		<p>Software, AI, design</p>
	</a>
	{% set blog_section = get_section(path="blog/_index.md") -%}
	<a class=ml-card-anchor href="/blog">
		<h2>Blog</h2>
		<p>{{ blog_section.pages | length }} posts</p>
	</a>
	<div class=ml-card-anchor style="grid-area: span 4/span 4; display: grid; grid-template-rows: subgrid; line-height: 1.25">
		{% set newest_post = blog_section.pages | first %}
		<a style="grid-row: span 3; overflow-y: hidden; font-size: 1rem; color: inherit"
		href="{{ newest_post.path }}" lang="{{ macros::lang(page=newest_post) }}">
			<div class=main-section>Updated on <time datetime="{{ newest_post.date }}">{{ macros::dm(date=newest_post.date) }} DM</time></div>
			<h2>{{ newest_post.title }}</h2>
			{{ newest_post.summary | striptags | truncate(length=308) }}
		</a>
		{% set other_posts = blog_section.pages | slice(start=1, end=3) %}
		<div style="grid-row: span 1; min-width: 0">
			{% for b in other_posts -%}
			<a class=ml-chokolate style="height: 2rem; border-bottom: none; align-items: center"
				href="{{ b.path }}" lang="{{ macros::lang(page=b) }}">
				<p style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis">{{ b.title }}</p>
				<time datetime="{{ b.date }}" class=ml-smaller>{{ macros::dm(date=b.date) }}</time>
			</a>
			{% endfor -%}
		</div>
	</div>
	<a class=ml-card-anchor href="https://lex.matling.fit">
		<h2>Lexicon Matlinae</h2>
		<p>Digital garden & self-hosting</p>
	</a>
	<a class=ml-card-anchor id=hometown href="https://ma.pona.la">
		<div class=btm><h2>Glang–Wys</h2><p>Where I spawned</p></div>
	</a>
	<div style="grid-row: span 4" class=ml-card-anchor>
		<h2>Clarion</h2>
	</div>
</section>
</main>
<script>
(() => {
	const contribDays = 50 + new Date().getDay();
	const url = "https://wakatime.com/share/@b24b10b3-9f1c-4323-9f99-e0b3888b3a6a/ae2b847c-d654-4f58-ab53-03bd64a7eda6.json";
	const contrib = document.getElementById("contrib");
	if (contrib)
		fetch(url).then(resp => resp.json()).then(data => {
			console.log(data);
			const days = data.days.slice(-contribDays);
			const result = document.createElement("div");
			contrib.append(result);
			for (let x of days) {
				const level = [1, 3, 4, 8, 10].findIndex(y => y > x.total / 3600);
				const res = document.createElement("span");
				res.setAttribute("data-l", level);
				result.append(res);
			}
		});
})()
</script>
{% endblock body %}
