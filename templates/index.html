{% extends "fault.html" %}
{% import "macros.html" as macros %}
{% block head %}{% if section.path == "/" %}{{ super() }}
 <link rel=alternate type="application/atom+xml" href="/feed.xml">
 <style>
body {
	display: flex;
	align-items: center;
}

html, body {
	height: 100%;
	overflow-x: auto;
}

@keyframes typing-single {
	from, to { width: 0; }
	27%, 93% { width: 100%; }
}

@keyframes typing-robin {
	from { max-width: 0; }
	to { max-width: 100%; }
}

@keyframes typing-cursor {
	from { color: transparent; }
	to { color: var(--color-levity); }
}
h1 {
	padding: 0;
	display: flex;
	height: 40px;
}

h1 span {
	animation: typing-robin calc(4s * var(--count)) linear(1, 1 calc(100% / var(--count)), 0 calc(100% / var(--count)), 0) infinite, typing-single 4s infinite;
	word-break: break-all;
	overflow: hidden;
	width: 0;
}

h1 > :first-child {
	width: 100%;
}

#top > form > object {
	opacity: 0.6;
	margin-inline: auto;
	display: block;
}

#top > form:focus-within > object {
	opacity: 0.9;
}

h1 span::after {
	margin-inline-start: 2px;
	content: '_';
	animation: typing-cursor 1s steps(2) infinite;
}

.ml-article::after {
	background: url(/img/hello-page.svg);
	align-self: flex-end;
	content: '';
	height: 408px;
	width: 180px;
	filter: contrast(0.3);
}

#top-wrapper {
	width: 21em;
	max-height: 47rem;
}

@media screen and (max-width: 540px) {
	.ml-bookmark {
		padding: 0;
	}
	#top-wrapper {
		width: calc(100vw - 4em);
	}
}

a.bigger {
	font-size: 1.125em;
	height: 2rem;
	border-bottom: none;
	align-items: center;
}

@media screen and (max-height: 800px) {
	:root .card-block {
		--grid-size: 4rem;
		gap: 0.75rem;
	}
	:root .ml-card-anchor {
		padding-inline: 0.75rem;
	}
	.card-block h2 {
		margin-top: 0.625em;
	}
	a.bigger {
		font-size: unset;
		height: 1.625rem;
	}
}

.ml-article {
	gap: 6em;
	display: flex;
	max-width: unset;
}

.ml-card-anchor {
	box-sizing: border-box;
	font-size: 1rem;
	line-height: 1.25;
	grid-area: span 2/span 2;
	padding-inline: 1em;
	position: relative;
	background-blend-mode: soft-light;
	background-size: contain;
}
a.ml-card-anchor {
	border-bottom: none;
}

.ml-card-anchor img {
	position: absolute;
	inset: 0;
	object-fit: cover;
	z-index: -1;
}

.card-block {
	--grid-size: 5rem;
	grid: repeat(8, var(--grid-size)) / auto-flow var(--grid-size);
	gap: 1rem;
	display: grid;
}

.card-block h2 {
	margin: 1rem 0 0.25em;
}
.card-block p {
	margin: 0;
}

#contrib div {
	display: grid;
	grid: repeat(7, 12px) / auto-flow 12px;
	gap: 6px;
	right: 0.5rem;
	bottom: 0.75rem;
	position: absolute;
}

#contrib span[data-l="0"] { background: light-dark(var(--cl0), var(--cl5)); }
#contrib span[data-l="1"] { background: light-dark(var(--cl1), var(--cl4)); }
#contrib span[data-l="2"] { background: light-dark(var(--cl2), var(--cl3)); }
#contrib span[data-l="3"] { background: light-dark(var(--cl3), var(--cl2)); }
#contrib span[data-l="4"] { background: light-dark(var(--cl4), var(--cl1)); }

body {
	--cl0: #EBEDF0;
	--cl1: #B4C7D9;
	--cl2: #8BAAC5;
	--cl3: #527DA4;
	--cl4: #36526C;
	--cl5: #161b22;
}

#hometown {
	--color-card: light-dark(#777, #555);
	background-image: url(/hp-temp/hp-qingo.jpg);
}

#hometown:not(:hover) p, #hometown:not(:hover) h2 { color: #e6e6dc; }

.main-section {
	color: var(--color-heavy);
	margin-top: 0.75em;
	font-size: 1rem;
}

.btm {
	bottom: 1em;
	position: absolute;
}

#ligi::after, #ligi::before {
	display: block;
	content: '';
}
#ligi::after {
	background: repeating-linear-gradient(transparent, transparent 27px, var(--nr) 27px, var(--nr) 28px);
	height: 50%;
}
#ligi::before {
	content: 'No. Date';
	padding: 0.75em 50% 3px;
	border-bottom: 1px solid var(--nr);
	color: var(--nr);
}
 </style>
{% else %}
<meta charset="utf-8">
<title>Redirect</title>
<script>
  const target = window.location.origin;
  const hash = window.location.hash || "";
  window.location.replace(target + hash);
</script>
<noscript>
  <meta http-equiv="refresh" content="0; url=/">
</noscript>
<p><a href="/">Click me</a>; homepage is temporarily not translated.</p>
{% endif %}
{% endblock head %}
{% block body %}{% if section.path == "/" %}
<main class="ml-article">
<section style="position:relative;padding:1em" id="top-wrapper">
	<div id="top">
	<form>
		<object data="/img/latek.svg" title="Matling" type="image/svg+xml" height=192></object>
		<textarea name=q placeholder="Ask anything" style="background:none;border-width:0;border-bottom-width:1px;padding:0.5rem 4px;font:inherit;font-size:1.125rem;width:100%;resize:none"></textarea>
	</form>
	</div>	
	<footer class=ml-chokolate style="align-items:center;inset:auto 0 0;position:absolute">
		<p class=ml-smaller><a href="https://icp.gov.moe/?keyword=20243727" target="_blank">萌ICP备20243727号</a></p>
		<i id=advanced class=dropdown-wrapper></i>
	</footer>
</section>
<section class=card-block>
	<div class=ml-card-anchor>
		<p style="margin:0.9em 0 0.1em;font-size:1.25em">Hi~ I am</p>
		<h1 style="--count:5">
			<span style="animation-delay:-16s">Matling</span>
			<span style="animation-delay:-12s" lang=ar><bdi>متلينغ</bdi></span>
			<span style="animation-delay:-8s" lang=chr>ᎹᏟᏂ</span>
			<span style="animation-delay:-4s" lang=uk>Матлін</span>
			<span lang=zh>物灵</span>
		</h1>
		<p class=btm lang=la>In patria peregrinor</p>
	</div>
	{% set blog_section = get_section(path="blog/_index.md") -%}
	<a class=ml-card-anchor href="/blog">
		<h2>Blog</h2>
		<p>{{ blog_section.pages | length }} posts</p>
	</a>
	<div class=ml-card-anchor style="grid-area: span 4/span 4; display: grid; grid-template-rows: subgrid; line-height: 1.25">
		{% set newest_post = blog_section.pages | first %}
		<a style="grid-row: span 3; overflow-y: hidden; font-size: 1rem; color: inherit; border-bottom: none"
		href="{{ newest_post.path }}" lang="{{ macros::lang(page=newest_post) }}" {{ macros::lang_rtl(lang=macros::lang(page=newest_post)) }}>
			<div class=main-section lang=en>Updated on <time datetime="{{ newest_post.date }}">{{ macros::dm(date=newest_post.date) }} DM</time></div>
			<h2>{{ newest_post.title }}</h2>
			{{ newest_post.summary | striptags | truncate(length=308) }}
		</a>
		{% set other_posts = blog_section.pages | slice(start=1, end=3) %}
		<div style="grid-row: span 1; min-width: 0">
			{% for b in other_posts -%}
			<a class="ml-chokolate bigger" href="{{ b.path }}" lang="{{ macros::lang(page=b) }}">
				<p style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis">{{ b.title }}</p>
				<time datetime="{{ b.date }}" class=ml-smaller>{{ macros::dm(date=b.date) }}</time>
			</a>
			{% endfor -%}
		</div>
	</div>
	<a class=ml-card-anchor style="grid-column: span 4" id=contrib 
	href="https://github.com/0xis-cn" rel="me" target=_blank>
		<h2>Contribution</h2>
		<p>Software, AI, design</p>
	</a>
	<a class=ml-card-anchor href="https://lex.matling.fit">
		<h2>Lexicon Matlinae</h2>
		<p>Digital garden & secret lab</p>
	</a>
	<a style="grid-row: span 4; --nr: indianred;" class=ml-card-anchor href="/about/ligi" id=ligi>
		<p style="text-align: center; margin-top: 0.75em">
		<span style="font-size: 1.25em">Selected works</span><br><i>of</i><br>
		<span style="font-variant: small-caps; font-size: 2em; line-height: 1">Ligi Studio</span>
		</p>
	</a>
	<a class=ml-card-anchor id=hometown href="https://ma.pona.la">
		<div class=btm><h2>Glang–Wys</h2><p>Where I spawned</p></div>
	</a>
	<!--TODO: https://fedi.fsfans.club/-->
</section>
</main>
<script>
(() => {
	const contribDays = 50 + new Date().getDay();
	const url = "https://wakatime.com/share/@b24b10b3-9f1c-4323-9f99-e0b3888b3a6a/ae2b847c-d654-4f58-ab53-03bd64a7eda6.json";
	const contrib = document.getElementById("contrib");
	if (contrib)
		fetch(url).then(resp => resp.json()).then(data => {
			console.log(data);
			const days = data.days.slice(-contribDays);
			const result = document.createElement("div");
			contrib.append(result);
			for (let x of days) {
				const level = [1, 3, 4, 8, 10].findIndex(y => y > x.total / 3600);
				const res = document.createElement("span");
				res.setAttribute("data-l", level);
				result.append(res);
			}
		});
})()
</script>
{% endif %}{% endblock body %}
